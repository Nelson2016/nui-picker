!function(t){function i(t,i){for(var e=Object.getOwnPropertyNames(t),o=0;o<e.length;o++)if(!(e[o]in i)){var s=Object.getOwnPropertyDescriptor(t,e[o]);Object.defineProperty(i,e[o],s)}return i}var e=function(t,e){if("ontouchstart"in window){e=e||{};var o={item:{size:16,height:25,color:"#333333"},opacityDif:.3,sizeDif:1.5,panelBg:"#f7f7f7",padding:15,lineNum:5,px2rem:!1,confirm:{size:14,height:40,color:"#ffffff",background:"#d0021b"},title:{size:20,color:"#333333"}};this.options=i(o,e),this.options.closeCallback=this.options.closeCallback||function(){},this.data=t||[],this.result=[],this.createDoms(),this.bindEvt()}else console.error("仅支持移动端浏览器!")};e.prototype={bindEvt:function(){this.confirmEvt(),this.closeEvt(),this.bindScroll()},createClassName:function(){this._picker="nui-date-picker",this._container=this._picker+"-container",this._inner=this._picker+"-inner",this._scroll=this._picker+"-scroll",this._fix=this._picker+"-fix",this._confirm=this._picker+"-confirm",this._mask=this._picker+"-mask"},open:function(){this.picker.style.opacity=1,this.picker.style.mozOpacity=1,this.picker.style.top=0},hide:function(){this.picker.style.opacity=0,this.picker.style.mozOpacity=0,this.picker.style.top="100%"},createDoms:function(){this.createClassName();var t=document.createElement("div");t.className=this._picker,t.id=this._picker;var i=this.options,e=i.confirm,o=parseFloat(i.item.height);this.panelInnerHeight=o*parseFloat(i.lineNum),this.halfItemHeight=this.options.item.height/2,this.halfPanelHeight=this.panelInnerHeight/2,this.topBoundary=this.halfPanelHeight-this.halfItemHeight;for(var s=this.mathCssStr({height:this.panelInnerHeight+30,background:i.panelBg,bottom:e.height}),n=this.mathCssStr({height:o,"line-height":o}),h=this.mathCssStr({height:this.panelInnerHeight,"line-height":this.panelInnerHeight}),a=this.mathCssStr({height:e.height,"font-size":e.size,background:e.background,color:e.color}),c=['<div class="'+this._mask+'" id="'+this._mask+'"></div>','<div id="'+this._container+'" class="'+this._container+'" style="'+s+'"><div class="'+this._inner+'">'],r=0,l=0;l<this.data.length;l++)this.data[l].title&&r++;for(var p=(document.body.clientWidth-2*this.options.padding-40*r)/this.data.length,f=0;f<this.data.length;f++){for(var d=this.data[f],u=d.data||[],g='<div class="'+this._scroll+'"><ul style="width: '+p+'px;">',m=[],y=0;y<u.length;y++)m.push('<li style="'+n+'"><span>'+u[y]+"</span></li>");g+=m.join(""),g+="</ul></div>",d.title&&(g+='<div class="'+this._fix+'"><span style="'+h+'">'+d.title+"</span></div>")&&r++,c.push(g)}c.push('</div></div><button id="'+this._confirm+'" class="'+this._confirm+'" style="'+a+'">确定</button>'),t.innerHTML=c.join(""),document.body.appendChild(t),this.picker=document.getElementById(this._picker),t=null},bindScroll:function(){for(var t=this,i=document.querySelectorAll("."+this._scroll),e=0;e<i.length;e++)!function(e){var o=i[e],s=o.children[0],n=0,h=0,a=0,c=0;t.modifyActive(s,e),o.addEventListener("touchstart",function(t){t.stopPropagation(),n=Date.now(),h=t.touches[0].clientY,c=h}),o.addEventListener("touchmove",function(i){i.stopPropagation(),a=i.changedTouches[0].clientY-c,t.scroll(s,a,e),c=i.changedTouches[0].clientY}),o.addEventListener("touchend",function(i){var o=i.changedTouches[0].clientY-h,c=o>0?-1:1;t.endScroll(s,a,n,Date.now(),c,o,e)})}(e)},getSpeed:function(t,i,e){return Math.abs(t)/(e-i)||0},scroll:function(t,i,e){i=null===this.checkScroll(t,t.offsetTop+i)?i:i/3,t.style.top=t.offsetTop-this.options.padding+i+"px",this.modifyActive(t,e)},checkScroll:function(t,i){var e=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;return i>=0&&i>this.topBoundary?"down":!(i<=0&&-i>e)||"up"},endScroll:function(t,i,e,o,s,n,h){if(!0!==this.checkScroll(t,t.offsetTop+i)){if(-1===s)this.toBoundary(t,this.topBoundary,s,h);else if(1===s){var a=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;this.toBoundary(t,-a,s,h)}}else this.inertia(t,n,e,o,s,h)},toBoundary:function(t,i,e,o){var s=this,n=setInterval(function(){var h=t.offsetTop+1*e-s.options.padding;t.style.top=h+"px",s.modifyActive(t,o),(e<0&&h<=i||e>0&&h>=i)&&(clearInterval(n),t.style.top=i+"px")},2)},inertia:function(t,i,e,o,s,n){var h=this,a=12*this.getSpeed(i,e,o),c=setInterval(function(){var i=t.offsetTop+s*-a-h.options.padding;if(t.style.top=i+"px",h.modifyActive(t,n),a<=.5)if(clearInterval(c),!0!==h.checkScroll(t,t.offsetTop)){if(-1===s)h.toBoundary(t,h.topBoundary,s,n);else if(1===s){var e=t.offsetHeight-h.halfPanelHeight-h.halfItemHeight;h.toBoundary(t,-e,s,n)}}else{var o=t.offsetTop-h.options.padding,r=o%h.options.item.height,l=o/h.options.item.height,p=o;p=r>0?r>h.halfItemHeight?h.options.item.height*Math.ceil(l):h.options.item.height*Math.floor(l):r>h.halfItemHeight?h.options.item.height*Math.floor(l):h.options.item.height*Math.ceil(l),h.toBoundary(t,p,s,n)}a--},10)},modifyActive:function(t,i){var e=t.offsetTop-this.options.padding,o=2.5*this.options.item.height-e,s=t.children,n=Math.floor(o/this.options.item.height);n>s.length-1?n=s.length-1:n<0&&(n=0),this.result[i]=s[n].innerText,s[n].style.fontSize=this.options.item.size+"px",s[n].style.opacity=1,s[n+1]&&(s[n+1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),s[n-1]&&(s[n-1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),s[n+1]&&(s[n+1].style.opacity=1-this.options.opacityDif),s[n-1]&&(s[n-1].style.opacity=1-this.options.opacityDif),s[n+2]&&(s[n+2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),s[n-2]&&(s[n-2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),s[n+2]&&(s[n+2].style.opacity=1-2*this.options.opacityDif),s[n-2]&&(s[n-2].style.opacity=1-2*this.options.opacityDif)},confirmEvt:function(){this.tap(document.getElementById(this._confirm),this.options.confirmCallback)},closeEvt:function(){this.tap(document.getElementById(this._mask),this.options.closeCallback)},tap:function(t,i){var e=0,o=0,s=0,n=this;t.addEventListener("touchstart",function(t){t.stopPropagation(),e=Date.now(),o=t.touches[0].clientX,s=t.touches[0].clientY}),t.addEventListener("touchend",function(t){t.stopPropagation(),Math.abs(t.changedTouches[0].clientX-o)<=10&&Math.abs(t.changedTouches[0].clientY-s)<=10&&Date.now()-e<=200&&i.call(n,n.result)})},mathCssStr:function(t){var i="",e=["height","line-height","font-size","bottom"];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];e.indexOf(o)>-1?i+=o+":"+this.px2rem(s):i+=o+":"+s,i+=";"}return i},px2rem:function(t){return this.options.px2rem?t/16+"rem":t+"px"}},window.NuiPicker=function(t,i){return new e(t,i)}}();