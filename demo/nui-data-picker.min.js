!function(t){function i(t,i){for(var e=Object.getOwnPropertyNames(t),o=0;o<e.length;o++)if(!(e[o]in i)){var n=Object.getOwnPropertyDescriptor(t,e[o]);Object.defineProperty(i,e[o],n)}return i}var e=function(t,e){if("ontouchstart"in window){e=e||{};var o={item:{size:16,height:25,color:"#333333"},opacityDif:.3,sizeDif:1.5,panelBg:"#f7f7f7",padding:15,lineNum:5,px2rem:!1,confirm:{size:14,height:40,color:"#ffffff",background:"#d0021b"},title:{size:20,color:"#333333"}};this.options=i(o,e),this.data=t||[],this.createDoms(),this.bindEvt()}else console.error("仅支持移动端浏览器!")};e.prototype={bindEvt:function(){this.confirmEvt(),this.bindScroll()},createClassName:function(){this._picker="nui-date-picker",this._container=this._picker+"-container",this._inner=this._picker+"-inner",this._scroll=this._picker+"-scroll",this._fix=this._picker+"-fix",this._confirm=this._picker+"-confirm"},createDoms:function(){this.createClassName();var t=document.createElement("div");t.className=this._picker;var i=this.options,e=i.confirm,o=parseFloat(i.item.height);this.panelInnerHeight=o*parseFloat(i.lineNum),this.halfItemHeight=this.options.item.height/2,this.halfPanelHeight=this.panelInnerHeight/2,this.topBoundary=this.halfPanelHeight-this.halfItemHeight;for(var n=this.mathCssStr({height:this.panelInnerHeight+30,background:i.panelBg,bottom:e.height}),s=this.mathCssStr({height:o,"line-height":o}),h=this.mathCssStr({height:this.panelInnerHeight,"line-height":this.panelInnerHeight}),a=this.mathCssStr({height:e.height,"font-size":e.size,background:e.background,color:e.color}),r=['<div id="nui-date-picker-container" class="nui-date-picker-container" style="'+n+'"><div class="nui-date-picker-inner">'],c=0,l=0;l<this.data.length;l++)this.data[l].title&&c++;for(var p=(document.body.clientWidth-2*this.options.padding-40*c)/this.data.length,f=0;f<this.data.length;f++){for(var d=this.data[f],u=d.data||[],g='<div class="nui-date-picker-scroll"><ul style="width: '+p+'px;">',m=[],v=0;v<u.length;v++)m.push('<li style="'+s+'"><span>'+u[v]+"</span></li>");g+=m.join(""),g+="</ul></div>",d.title&&(g+='<div class="nui-date-picker-fix"><span style="'+h+'">'+d.title+"</span></div>")&&c++,r.push(g)}r.push('</div></div><button id="nui-date-picker-confirm" class="nui-date-picker-confirm" style="'+a+'">确定</button>'),t.innerHTML=r.join(""),document.body.appendChild(t)},bindScroll:function(){for(var t=this,i=document.querySelectorAll("."+this._scroll),e=0;e<i.length;e++)!function(e){var o=i[e],n=o.children[0],s=0,h=0,a=0,r=0;t.modifyActive(n),o.addEventListener("touchstart",function(t){t.stopPropagation(),s=Date.now(),h=t.touches[0].clientY,r=h}),o.addEventListener("touchmove",function(i){i.stopPropagation(),a=i.changedTouches[0].clientY-r,t.scroll(n,a),r=i.changedTouches[0].clientY}),o.addEventListener("touchend",function(i){var e=i.changedTouches[0].clientY-h,o=e>0?-1:1;t.endScroll(n,a,s,Date.now(),o,e)})}(e)},getSpeed:function(t,i,e){return Math.abs(t)/(e-i)||0},scroll:function(t,i){i=null===this.checkScroll(t,t.offsetTop+i)?i:i/3,t.style.top=t.offsetTop-this.options.padding+i+"px",this.modifyActive(t)},checkScroll:function(t,i){var e=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;return i>=0&&i>this.topBoundary?"down":!(i<=0&&-i>e)||"up"},endScroll:function(t,i,e,o,n,s){if(!0!==this.checkScroll(t,t.offsetTop+i)){if(-1===n)this.toBoundary(t,this.topBoundary,n);else if(1===n){var h=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;this.toBoundary(t,-h,n)}}else this.inertia(t,s,e,o,n)},toBoundary:function(t,i,e){var o=this,n=setInterval(function(){var s=t.offsetTop+1*e-o.options.padding;t.style.top=s+"px",o.modifyActive(t),(e<0&&s<=i||e>0&&s>=i)&&(clearInterval(n),t.style.top=i+"px")},2)},inertia:function(t,i,e,o,n){var s=this,h=12*this.getSpeed(i,e,o),a=setInterval(function(){var i=t.offsetTop+n*-h-s.options.padding;if(t.style.top=i+"px",s.modifyActive(t),h<=.5)if(clearInterval(a),!0!==s.checkScroll(t,t.offsetTop)){if(-1===n)s.toBoundary(t,s.topBoundary,n);else if(1===n){var e=t.offsetHeight-s.halfPanelHeight-s.halfItemHeight;s.toBoundary(t,-e,n)}}else{var o=t.offsetTop-s.options.padding,r=o%s.options.item.height,c=o/s.options.item.height,l=o;l=r>0?r>s.halfItemHeight?s.options.item.height*Math.ceil(c):s.options.item.height*Math.floor(c):r>s.halfItemHeight?s.options.item.height*Math.floor(c):s.options.item.height*Math.ceil(c),s.toBoundary(t,l,n)}h--},10)},modifyActive:function(t){var i=t.offsetTop-this.options.padding,e=2.5*this.options.item.height-i,o=t.children,n=Math.floor(e/this.options.item.height);n>o.length-1?n=o.length-1:n<0&&(n=0),o[n].style.fontSize=this.options.item.size+"px",o[n].style.opacity=1,o[n+1]&&(o[n+1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),o[n-1]&&(o[n-1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),o[n+1]&&(o[n+1].style.opacity=1-this.options.opacityDif),o[n-1]&&(o[n-1].style.opacity=1-this.options.opacityDif),o[n+2]&&(o[n+2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),o[n-2]&&(o[n-2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),o[n+2]&&(o[n+2].style.opacity=1-2*this.options.opacityDif),o[n-2]&&(o[n-2].style.opacity=1-2*this.options.opacityDif)},confirmEvt:function(){var t=this,i=0,e=0,o=0,n=document.getElementById("nui-date-picker-confirm");n.addEventListener("touchstart",function(t){t.stopPropagation(),i=Date.now(),e=t.touches[0].clientX,o=t.touches[0].clientY}),n.addEventListener("touchend",function(n){n.stopPropagation(),Math.abs(n.changedTouches[0].clientX-e)<=10&&Math.abs(n.changedTouches[0].clientY-o)<=10&&Date.now()-i<=200&&t.options.confirmCallback()})},mathCssStr:function(t){var i="",e=["height","line-height","font-size","bottom"];for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];e.indexOf(o)>-1?i+=o+":"+this.px2rem(n):i+=o+":"+n,i+=";"}return i},px2rem:function(t){return this.options.px2rem?t/16+"rem":t+"px"}},window.NuiPicker=function(t,i){return new e(t,i)}}();