!function(t){function i(t,i){for(var e=Object.getOwnPropertyNames(t),o=0;o<e.length;o++)if(!(e[o]in i)){var s=Object.getOwnPropertyDescriptor(t,e[o]);Object.defineProperty(i,e[o],s)}return i}var e=function(t,e){if("ontouchstart"in window){e=e||{};var o={item:{size:16,height:25,color:"#333333"},opacityDif:.3,sizeDif:1.5,panelBg:"#f7f7f7",padding:15,lineNum:5,px2rem:!1,confirm:{size:14,height:40,color:"#ffffff",background:"#d0021b"},title:{size:20,color:"#333333"}};this.options=i(o,e),this.data=t||[],this.createDoms(),this.bindEvt()}else console.error("仅支持移动端浏览器!")};e.prototype={bindEvt:function(){this.confirmEvt(),this.closeEvt(),this.bindScroll()},createClassName:function(){this._picker="nui-date-picker",this._container=this._picker+"-container",this._inner=this._picker+"-inner",this._scroll=this._picker+"-scroll",this._fix=this._picker+"-fix",this._confirm=this._picker+"-confirm",this._mask=this._picker+"-mask"},open:function(){this.picker.style.opacity=1,this.picker.style.mozOpacity=1,this.picker.style.top=0},hide:function(){this.picker.style.opacity=0,this.picker.style.mozOpacity=0,this.picker.style.top="100%"},createDoms:function(){this.createClassName();var t=document.createElement("div");t.className=this._picker,t.id=this._picker;var i=this.options,e=i.confirm,o=parseFloat(i.item.height);this.panelInnerHeight=o*parseFloat(i.lineNum),this.halfItemHeight=this.options.item.height/2,this.halfPanelHeight=this.panelInnerHeight/2,this.topBoundary=this.halfPanelHeight-this.halfItemHeight;for(var s=this.mathCssStr({height:this.panelInnerHeight+30,background:i.panelBg,bottom:e.height}),n=this.mathCssStr({height:o,"line-height":o}),h=this.mathCssStr({height:this.panelInnerHeight,"line-height":this.panelInnerHeight}),a=this.mathCssStr({height:e.height,"font-size":e.size,background:e.background,color:e.color}),c=['<div class="'+this._mask+'" id="'+this._mask+'"></div>','<div id="'+this._container+'" class="'+this._container+'" style="'+s+'"><div class="'+this._inner+'">'],r=0,l=0;l<this.data.length;l++)this.data[l].title&&r++;for(var p=(document.body.clientWidth-2*this.options.padding-40*r)/this.data.length,f=0;f<this.data.length;f++){for(var d=this.data[f],u=d.data||[],g='<div class="'+this._scroll+'"><ul style="width: '+p+'px;">',m=[],y=0;y<u.length;y++)m.push('<li style="'+n+'"><span>'+u[y]+"</span></li>");g+=m.join(""),g+="</ul></div>",d.title&&(g+='<div class="'+this._fix+'"><span style="'+h+'">'+d.title+"</span></div>")&&r++,c.push(g)}c.push('</div></div><button id="'+this._confirm+'" class="'+this._confirm+'" style="'+a+'">确定</button>'),t.innerHTML=c.join(""),document.body.appendChild(t),this.picker=document.getElementById(this._picker),t=null},bindScroll:function(){for(var t=this,i=document.querySelectorAll("."+this._scroll),e=0;e<i.length;e++)!function(e){var o=i[e],s=o.children[0],n=0,h=0,a=0,c=0;t.modifyActive(s),o.addEventListener("touchstart",function(t){t.stopPropagation(),n=Date.now(),h=t.touches[0].clientY,c=h}),o.addEventListener("touchmove",function(i){i.stopPropagation(),a=i.changedTouches[0].clientY-c,t.scroll(s,a),c=i.changedTouches[0].clientY}),o.addEventListener("touchend",function(i){var e=i.changedTouches[0].clientY-h,o=e>0?-1:1;t.endScroll(s,a,n,Date.now(),o,e)})}(e)},getSpeed:function(t,i,e){return Math.abs(t)/(e-i)||0},scroll:function(t,i){i=null===this.checkScroll(t,t.offsetTop+i)?i:i/3,t.style.top=t.offsetTop-this.options.padding+i+"px",this.modifyActive(t)},checkScroll:function(t,i){var e=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;return i>=0&&i>this.topBoundary?"down":!(i<=0&&-i>e)||"up"},endScroll:function(t,i,e,o,s,n){if(!0!==this.checkScroll(t,t.offsetTop+i)){if(-1===s)this.toBoundary(t,this.topBoundary,s);else if(1===s){var h=t.offsetHeight-this.halfPanelHeight-this.halfItemHeight;this.toBoundary(t,-h,s)}}else this.inertia(t,n,e,o,s)},toBoundary:function(t,i,e){var o=this,s=setInterval(function(){var n=t.offsetTop+1*e-o.options.padding;t.style.top=n+"px",o.modifyActive(t),(e<0&&n<=i||e>0&&n>=i)&&(clearInterval(s),t.style.top=i+"px")},2)},inertia:function(t,i,e,o,s){var n=this,h=12*this.getSpeed(i,e,o),a=setInterval(function(){var i=t.offsetTop+s*-h-n.options.padding;if(t.style.top=i+"px",n.modifyActive(t),h<=.5)if(clearInterval(a),!0!==n.checkScroll(t,t.offsetTop)){if(-1===s)n.toBoundary(t,n.topBoundary,s);else if(1===s){var e=t.offsetHeight-n.halfPanelHeight-n.halfItemHeight;n.toBoundary(t,-e,s)}}else{var o=t.offsetTop-n.options.padding,c=o%n.options.item.height,r=o/n.options.item.height,l=o;l=c>0?c>n.halfItemHeight?n.options.item.height*Math.ceil(r):n.options.item.height*Math.floor(r):c>n.halfItemHeight?n.options.item.height*Math.floor(r):n.options.item.height*Math.ceil(r),n.toBoundary(t,l,s)}h--},10)},modifyActive:function(t){var i=t.offsetTop-this.options.padding,e=2.5*this.options.item.height-i,o=t.children,s=Math.floor(e/this.options.item.height);s>o.length-1?s=o.length-1:s<0&&(s=0),o[s].style.fontSize=this.options.item.size+"px",o[s].style.opacity=1,o[s+1]&&(o[s+1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),o[s-1]&&(o[s-1].style.fontSize=this.options.item.size-this.options.sizeDif+"px"),o[s+1]&&(o[s+1].style.opacity=1-this.options.opacityDif),o[s-1]&&(o[s-1].style.opacity=1-this.options.opacityDif),o[s+2]&&(o[s+2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),o[s-2]&&(o[s-2].style.fontSize=this.options.item.size-2*this.options.sizeDif+"px"),o[s+2]&&(o[s+2].style.opacity=1-2*this.options.opacityDif),o[s-2]&&(o[s-2].style.opacity=1-2*this.options.opacityDif)},confirmEvt:function(){this.tap(document.getElementById(this._confirm),this.options.confirmCallback)},closeEvt:function(){this.tap(document.getElementById(this._mask),this.hide)},tap:function(t,i){var e=0,o=0,s=0,n=this;t.addEventListener("touchstart",function(t){t.stopPropagation(),e=Date.now(),o=t.touches[0].clientX,s=t.touches[0].clientY}),t.addEventListener("touchend",function(t){t.stopPropagation(),Math.abs(t.changedTouches[0].clientX-o)<=10&&Math.abs(t.changedTouches[0].clientY-s)<=10&&Date.now()-e<=200&&i.call(n)})},mathCssStr:function(t){var i="",e=["height","line-height","font-size","bottom"];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];e.indexOf(o)>-1?i+=o+":"+this.px2rem(s):i+=o+":"+s,i+=";"}return i},px2rem:function(t){return this.options.px2rem?t/16+"rem":t+"px"}},window.NuiPicker=function(t,i){return new e(t,i)}}();